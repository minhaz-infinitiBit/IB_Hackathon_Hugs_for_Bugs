# Generated API Reference

This document lists all React Query hooks generated by Orval from the FastAPI backend.

---

## Hooks Overview

| Hook                                                                       | Method | Endpoint                                                | Description                                |
| -------------------------------------------------------------------------- | ------ | ------------------------------------------------------- | ------------------------------------------ |
| `useListProjectsFilesProjectsGet`                                          | GET    | `/files/projects/`                                      | List all projects                          |
| `useCreateProjectFilesProjectsPost`                                        | POST   | `/files/projects/`                                      | Create a new project                       |
| `useUploadPdfFilesUploadPdfProjectIdPost`                                  | POST   | `/files/upload-pdf/{project_id}`                        | Upload PDF files to a project              |
| `useListProjectFilesFilesProjectsProjectIdFilesGet`                        | GET    | `/files/projects/{project_id}/files`                    | List files in a project                    |
| `useProcessProjectFilesProcessProjectProjectIdPost`                        | POST   | `/files/process-project/{project_id}`                   | Process a project (classify documents)     |
| `useGetProjectOrderingFilesProjectsProjectIdOrderingGet`                   | GET    | `/files/projects/{project_id}/ordering`                 | Get project document ordering              |
| `useGetProjectClassificationsFilesProjectsProjectIdClassificationsGet`     | GET    | `/files/projects/{project_id}/classifications`          | Get project file classifications           |
| `useGetMergedPdfFilesProjectsProjectIdMergedPdfGet`                        | GET    | `/files/projects/{project_id}/merged-pdf`               | Get merged PDF metadata                    |
| `useDownloadMergedPdfFilesProjectsProjectIdMergedPdfDownloadGet`           | GET    | `/files/projects/{project_id}/merged-pdf/download`      | Download merged PDF file                   |
| `useGetProjectMemoryFilesProjectsProjectIdMemoryGet`                       | GET    | `/files/projects/{project_id}/memory`                   | Get project classification memory          |
| `useReclassifyFilesFilesProjectsProjectIdReclassifyPost`                   | POST   | `/files/projects/{project_id}/reclassify`               | Reclassify files with AI prompt            |
| `useUpdateFileCategoryFilesProjectsProjectIdFilesFileIdCategoryPut`        | PUT    | `/files/projects/{project_id}/files/{file_id}/category` | Update single file category                |
| `useGetAvailableCategoriesFilesProjectsProjectIdCategoriesGet`             | GET    | `/files/projects/{project_id}/categories`               | Get available categories with counts       |
| `useGetProjectGroupedByCategoryFilesProjectsProjectIdGroupedByCategoryGet` | GET    | `/files/projects/{project_id}/grouped-by-category`      | Get files grouped by German category       |
| `usePreviewFileFilesPreviewGet`                                            | GET    | `/files/preview`                                        | Preview file content (images, PDFs, Excel) |

---

## Hook Details

### `useListProjectsFilesProjectsGet`

**Type**: Query (GET)

**Parameters**:

```typescript
params?: {
  skip?: number;  // Pagination offset (default: 0)
  limit?: number; // Max results (default: 100)
}
```

**Returns**: `ProjectResponse[]`

```typescript
interface ProjectResponse {
	id: number;
	project_name: string;
	status: string;
}
```

**Usage**:

```tsx
const { data, isLoading } = useListProjectsFilesProjectsGet();
```

---

### `useCreateProjectFilesProjectsPost`

**Type**: Mutation (POST)

**Parameters**:

```typescript
{
	data: {
		project_name: string; // Required
	}
}
```

**Returns**: `ProjectResponse`

**Usage**:

```tsx
const mutation = useCreateProjectFilesProjectsPost();
mutation.mutate({ data: { project_name: "My Project" } });
```

---

### `useUploadPdfFilesUploadPdfProjectIdPost`

**Type**: Mutation (POST)

**Parameters**:

```typescript
{
  projectId: number; // Path parameter
  data: {
    files: Blob[];   // Array of PDF/image files
  }
}
```

**Returns**: `PDFUploadResponse[]`

```typescript
interface PDFUploadResponse {
	filename: string;
	content_type: string;
	message: string;
	location: string;
	project_id: number;
}
```

**Usage**:

```tsx
const mutation = useUploadPdfFilesUploadPdfProjectIdPost();
mutation.mutate({ projectId: 1, data: { files: [file1, file2] } });
```

---

### `useListProjectFilesFilesProjectsProjectIdFilesGet`

**Type**: Query (GET)

**Parameters**:

```typescript
projectId: number; // Path parameter (required)
```

**Returns**: `PDFUploadResponse[]`

**Usage**:

```tsx
const { data } = useListProjectFilesFilesProjectsProjectIdFilesGet(projectId);
```

---

### `useProcessProjectFilesProcessProjectProjectIdPost`

**Type**: Mutation (POST)

**Description**: Initiates document classification processing for a project.

**Parameters**:

```typescript
projectId: number; // Path parameter (required)
```

**Returns**: `unknown`

**Usage**:

```tsx
const mutation = useProcessProjectFilesProcessProjectProjectIdPost();
mutation.mutate({ projectId: 1 });
```

---

### `useGetProjectOrderingFilesProjectsProjectIdOrderingGet`

**Type**: Query (GET)

**Description**: Returns documents organized by category after classification is complete.

**Parameters**:

```typescript
projectId: number; // Path parameter (required)
```

**Returns**: `unknown` (document ordering structure)

**Usage**:

```tsx
const { data } =
	useGetProjectOrderingFilesProjectsProjectIdOrderingGet(projectId);
```

---

### `useGetProjectClassificationsFilesProjectsProjectIdClassificationsGet`

**Type**: Query (GET)

**Description**: Get classification results for files in a project. Optionally filter by category_id.

**Parameters**:

```typescript
projectId: number; // Path parameter (required)
params?: {
  category_id?: number; // Optional filter
}
```

**Returns**: `unknown` (classification results)

**Usage**:

```tsx
const { data } =
	useGetProjectClassificationsFilesProjectsProjectIdClassificationsGet(
		projectId,
		{ category_id: 1 }, // optional
	);
```

---

### `useGetMergedPdfFilesProjectsProjectIdMergedPdfGet`

**Type**: Query (GET)

**Description**: Get the merged PDF info for a project. Returns metadata about the merged PDF including preview and download URLs.

**Parameters**:

```typescript
projectId: number; // Path parameter (required)
```

**Returns**: `MergedPdfResponse`

```typescript
interface MergedPdfResponse {
	project_id: number;
	status: string; // "finished_processing", etc.
	merged_pdf_available: boolean;
	merged_pdf_path: string;
	merged_pdf_filename: string;
	preview_url: string; // URL for previewing the PDF
	file_size_bytes: number;
	download_url: string; // URL for downloading the PDF
}
```

**Usage**:

```tsx
const { data } = useGetMergedPdfFilesProjectsProjectIdMergedPdfGet(projectId);

// Access preview URL
const previewUrl = data?.data?.preview_url;

// Check if merged PDF is available
if (data?.data?.merged_pdf_available) {
	// Show the merged PDF viewer
}
```

---

### `useDownloadMergedPdfFilesProjectsProjectIdMergedPdfDownloadGet`

**Type**: Query (GET)

**Description**: Download the merged PDF file for a project.

**Parameters**:

```typescript
projectId: number; // Path parameter (required)
```

**Returns**: Binary PDF file

**Usage**:

```tsx
// Using the URL getter function for download
import { getDownloadMergedPdfFilesProjectsProjectIdMergedPdfDownloadGetUrl } from "@/api/generated/files/files";

const handleDownload = async (projectId: number) => {
	const baseUrl = import.meta.env.VITE_API_BASE_URL;
	const downloadPath =
		getDownloadMergedPdfFilesProjectsProjectIdMergedPdfDownloadGetUrl(
			projectId,
		);
	const response = await fetch(`${baseUrl}${downloadPath}`, {
		headers: { "ngrok-skip-browser-warning": "true" },
	});
	const blob = await response.blob();
	// Create download link...
};
```

---

### `useGetProjectMemoryFilesProjectsProjectIdMemoryGet`

**Type**: Query (GET)

**Description**: Get the project's classification results from agent memory. This endpoint retrieves the stored classification results for a project, which can be used to display current classifications before reclassification.

**Parameters**:

```typescript
projectId: number; // Path parameter (required)
```

**Returns**: `ProjectMemoryResponse`

**Usage**:

```tsx
const { data } = useGetProjectMemoryFilesProjectsProjectIdMemoryGet(projectId);
```

---

### `useReclassifyFilesFilesProjectsProjectIdReclassifyPost`

**Type**: Mutation (POST)

**Description**: Reclassify files using an AI prompt. Supports natural language instructions for reclassification.

**Parameters**:

```typescript
{
	projectId: number; // Path parameter
	data: ReclassificationRequest;
}

interface ReclassificationRequest {
	prompt: string; // Natural language reclassification instruction
	regenerate_pdf?: boolean; // Whether to regenerate merged PDF
}
```

**Returns**: `ReclassificationResponse`

**Usage**:

```tsx
const mutation = useReclassifyFilesFilesProjectsProjectIdReclassifyPost();
mutation.mutate({
	projectId: 1,
	data: {
		prompt: "Move all bank documents to Bankbescheinigungen category",
		regenerate_pdf: true,
	},
});
```

---

### `useUpdateFileCategoryFilesProjectsProjectIdFilesFileIdCategoryPut`

**Type**: Mutation (PUT)

**Description**: Update a single file's category. This is a simpler endpoint for updating just one file at a time. For bulk updates, use the reclassify endpoint.

**Parameters**:

```typescript
{
  projectId: number; // Path parameter
  fileId: number;    // Path parameter
  data: {
    new_category_id: number;
    reasoning?: string;
    regenerate_pdf?: boolean;
  }
}
```

**Returns**: `unknown`

**Usage**:

```tsx
const mutation =
	useUpdateFileCategoryFilesProjectsProjectIdFilesFileIdCategoryPut();
mutation.mutate({
	projectId: 1,
	fileId: 15,
	data: {
		new_category_id: 5,
		reasoning: "Document is an employment contract",
		regenerate_pdf: true,
	},
});
```

---

### `useGetAvailableCategoriesFilesProjectsProjectIdCategoriesGet`

**Type**: Query (GET)

**Description**: Get available categories with current file counts for a project. Returns all 20 categories with the count of files in each category, useful for displaying options when reclassifying files.

**Parameters**:

```typescript
projectId: number; // Path parameter (required)
```

**Returns**: Category list with counts

**Usage**:

```tsx
const { data } =
	useGetAvailableCategoriesFilesProjectsProjectIdCategoriesGet(projectId);
```

---

### `useGetProjectGroupedByCategoryFilesProjectsProjectIdGroupedByCategoryGet`

**Type**: Query (GET)

**Description**: Get all files for a specific project, grouped by their German category. Requires project to be in `finished_processing` status.

**Parameters**:

```typescript
projectId: number; // Path parameter (required)
```

**Returns**: `GroupedFilesResponse`

```typescript
interface GroupedFilesResponse {
	project_id: number;
	project_name: string;
	total_files: number;
	total_categories: number;
	grouped_files: CategoryGroup[];
}

interface CategoryGroup {
	category: string; // German category name (e.g., "Rechnungen", "Nicht Verwendbar")
	files: ClassifiedFile[];
}

interface ClassifiedFile {
	file_id: number;
	file_name: string;
	file_path: string;
	preview_url: string; // URL for file preview (use with baseUrl)
	confidence: string; // e.g., "0.99"
	reasoning: string; // AI reasoning for classification
}
```

**Usage**:

```tsx
const { data } =
	useGetProjectGroupedByCategoryFilesProjectsProjectIdGroupedByCategoryGet(
		projectId,
	);

// Access grouped files
data?.grouped_files.forEach((group) => {
	console.log(`Category: ${group.category}`);
	group.files.forEach((file) => console.log(`  - ${file.file_name}`));
});
```

---

### `usePreviewFileFilesPreviewGet`

**Type**: Query (GET)

**Description**: Get file content for previewing. Supports images, PDFs, Excel, etc. Includes security check to ensure file is within the data directory. Returns binary content that can be converted to a blob URL.

**Parameters**:

```typescript
params: {
	file_path: string; // File path to preview (required)
}
```

**Returns**: Binary file content

**Usage**:

```tsx
// Using fetch directly for blob URL creation
const baseUrl = import.meta.env.VITE_API_BASE_URL || "http://localhost:8000";
const response = await fetch(
	`${baseUrl}/files/preview?file_path=${encodeURIComponent(filePath)}`,
);
const blob = await response.blob();
const blobUrl = URL.createObjectURL(blob);

// Use in <iframe> for PDFs or <img> for images
```

---

## Import Path

```typescript
import {
	// Project Management
	useListProjectsFilesProjectsGet,
	useCreateProjectFilesProjectsPost,

	// File Upload & Listing
	useUploadPdfFilesUploadPdfProjectIdPost,
	useListProjectFilesFilesProjectsProjectIdFilesGet,

	// Processing
	useProcessProjectFilesProcessProjectProjectIdPost,

	// Classification & Ordering
	useGetProjectOrderingFilesProjectsProjectIdOrderingGet,
	useGetProjectClassificationsFilesProjectsProjectIdClassificationsGet,
	useGetProjectGroupedByCategoryFilesProjectsProjectIdGroupedByCategoryGet,

	// Merged PDF
	useGetMergedPdfFilesProjectsProjectIdMergedPdfGet,
	useDownloadMergedPdfFilesProjectsProjectIdMergedPdfDownloadGet,
	getDownloadMergedPdfFilesProjectsProjectIdMergedPdfDownloadGetUrl, // URL helper

	// Memory & Reclassification
	useGetProjectMemoryFilesProjectsProjectIdMemoryGet,
	useReclassifyFilesFilesProjectsProjectIdReclassifyPost,
	useUpdateFileCategoryFilesProjectsProjectIdFilesFileIdCategoryPut,
	useGetAvailableCategoriesFilesProjectsProjectIdCategoriesGet,

	// File Preview
	usePreviewFileFilesPreviewGet,
} from "@/api/generated/files/files";
```

---

## URL Getter Functions

In addition to the React Query hooks, Orval generates URL getter functions that return the endpoint path. These are useful for manual fetch calls (e.g., file downloads):

```typescript
// Generate download URL for merged PDF
getDownloadMergedPdfFilesProjectsProjectIdMergedPdfDownloadGetUrl(projectId: number)
// Returns: "/files/projects/{projectId}/merged-pdf/download"
```

**Usage Example:**

```typescript
const handleDownload = async () => {
	const baseUrl = import.meta.env.VITE_API_BASE_URL;
	const downloadPath =
		getDownloadMergedPdfFilesProjectsProjectIdMergedPdfDownloadGetUrl(
			projectId,
		);

	const response = await fetch(`${baseUrl}${downloadPath}`, {
		headers: { "ngrok-skip-browser-warning": "true" },
	});

	const blob = await response.blob();
	const url = URL.createObjectURL(blob);
	// Create download link...
};
```

---

## German Document Categories

The system uses 20 German document categories:

| ID  | Category (German)       | Translation              |
| --- | ----------------------- | ------------------------ |
| 1   | Rechnungen              | Invoices                 |
| 2   | Quittungen              | Receipts                 |
| 3   | Arbeitsverträge         | Employment Contracts     |
| 4   | Lohnabrechnungen        | Payslips                 |
| 5   | Beschäftigung           | Employment Documents     |
| 6   | Bankbescheinigungen     | Bank Certificates        |
| 7   | Versicherungsunterlagen | Insurance Documents      |
| 8   | Steuerbescheide         | Tax Assessments          |
| 9   | Mietverträge            | Rental Agreements        |
| 10  | Nebenkostenabrechnungen | Utility Bills            |
| 11  | Kindergeld              | Child Allowance          |
| 12  | Elterngeld              | Parental Allowance       |
| 13  | Spendenbelege           | Donation Receipts        |
| 14  | Handwerkerrechnungen    | Contractor Invoices      |
| 15  | Gesundheitskosten       | Healthcare Costs         |
| 16  | Weiterbildungskosten    | Training/Education Costs |
| 17  | Berufsausgaben          | Professional Expenses    |
| 18  | Kapitalerträge          | Capital Gains            |
| 19  | Riester/Rürup           | Retirement Plans         |
| 20  | Nicht Verwendbar        | Not Usable               |
